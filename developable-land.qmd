## Developable Land Summary

```{r}
#| include: false
source("R/common.R")
```

### Comprehensive Developability Analysis

```{r developable-summary, echo=FALSE}
# Summary of ALL developable land (not just top 10)
developable_summary <- property_profile |>
  filter(development_score >= 45) |>  # Tier 3 and above
  summarise(
    n_developable = n(),
    total_dev_acres = sum(area_acres, na.rm = TRUE),
    total_dev_value = sum(assessed_value, na.rm = TRUE),
    avg_attendance = mean(avg_attendance, na.rm = TRUE),
    avg_pledge = mean(avg_pledge, na.rm = TRUE),
    parcels_under_30 = sum(avg_attendance < 30, na.rm = TRUE)
  )

# By tier
tier_summary <- property_profile |>
  filter(development_score >= 45) |>
  group_by(development_potential) |>
  summarise(
    n_parcels = n(),
    total_acres = sum(area_acres, na.rm = TRUE),
    total_value = sum(assessed_value, na.rm = TRUE),
    .groups = "drop"
  ) |>
  arrange(desc(n_parcels))
```

```{r output-dev-summary, echo=FALSE, results='asis'}
#| echo: false
#| results: asis

cat("**All Developable Properties (Score â‰¥45)**\n\n")

cat("::: {layout-ncol=4}\n\n")

cat("::: {.value-box}\n")
cat("::: {.number}\n", developable_summary$n_developable, "\n:::\n", sep = "")
cat("::: {.label}\nDevelopable Parcels\n:::\n")
cat(":::\n\n")

cat("::: {.value-box .green}\n")
cat("::: {.number}\n", round(developable_summary$total_dev_acres, 1), "\n:::\n", sep = "")
cat("::: {.label}\nDevelopable Acres\n:::\n")
cat(":::\n\n")

cat("::: {.value-box .orange}\n")
cat("::: {.number}\n$", scales::comma(developable_summary$total_dev_value / 1e6, accuracy = 0.1), "M\n:::\n", sep = "")
cat("::: {.label}\nAssessed Value\n:::\n")
cat(":::\n\n")

cat("::: {.value-box .red}\n")
cat("::: {.number}\n", developable_summary$parcels_under_30, "\n:::\n", sep = "")
cat("::: {.label}\nWith <30 Attendance\n:::\n")
cat(":::\n\n")

cat(":::\n")

```


