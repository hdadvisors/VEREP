# Property Portfolio Overview

```{r}
#| include: false
source("R/common.R")
```

## Summary Metrics

```{r}
#| label: portfolio-metrics
#| results: asis
#| echo: false

# Calculate key metrics
total_properties <- nrow(property_profile)
total_acres <- sum(property_profile$area_acres, na.rm = TRUE)
avg_score <- mean(property_profile$development_score, na.rm = TRUE)
high_potential <- sum(property_profile$development_potential == "High", na.rm = TRUE)

cat("::: {layout-ncol=4}\n\n")

cat("::: {.callout-note appearance='minimal'}\n")
cat("## ", total_properties, "\n", sep = "")
cat("Total Parcels Analyzed\n")
cat(":::\n\n")

cat("::: {.callout-tip appearance='minimal'}\n")
cat("## ", format(round(total_acres, 0), big.mark = ","), "\n", sep = "")
cat("Total Acres Analyzed\n")
cat(":::\n\n")

cat("::: {.callout-warning appearance='minimal'}\n")
cat("## ", round(avg_score, 1), "\n", sep = "")
cat("Avg Development Score\n")
cat(":::\n\n")

cat("::: {.callout-important appearance='minimal'}\n")
cat("## ", high_potential, "\n", sep = "")
cat("High Potential Properties\n")
cat(":::\n\n")

cat(":::\n")
```
The distribution of development potential reflected in this analysis is common in institutional portfolios where properties were acquired for mission, not market value. The analysis's value lies in identifying the needles in the haystack—the 16 high-priority and 23 moderate-priority properties that can actually deliver financial returns—rather than pretending the entire portfolio has equal potential.

**In short:** A median development score of 35 proves the methodology is honest, makes the high-scoring properties more valuable by contrast, and provides clear strategic guidance: focus resources where they'll succeed rather than spreading them thin across a portfolio where most properties face fundamental limitations.

## Property Use Types

```{r}
#| label: fig-use-types
#| fig-cap: "Distribution of Properties by Primary Use"
#| fig-height: 5
#| echo: false

# Summarize use types
use_summary <- property_profile |>
  summarise(
    Church = sum(use_church, na.rm = TRUE),
    Parking = sum(use_parking, na.rm = TRUE),
    `Open Space` = sum(use_open_space, na.rm = TRUE),
    Residence = sum(use_residence, na.rm = TRUE),
    School = sum(use_school, na.rm = TRUE),
    Cemetery = sum(use_cemetery, na.rm = TRUE)
  ) |>
  pivot_longer(everything(), names_to = "Use Type", values_to = "Count") |>
  filter(Count > 0) |>
  arrange(desc(Count)) |>
  mutate(pct = Count / sum(Count) * 100)

ggplot(use_summary, aes(x = reorder(`Use Type`, Count), y = Count, fill = `Use Type`)) +
  geom_col() +
  geom_text(aes(label = paste0(Count, " (", round(pct, 1), "%)")), 
            hjust = -0.1, size = 3.5) +
  coord_flip() +
  scale_fill_manual(values = c(
    "Church" = "#445ca9",
    "Parking" = "#8baeaa",
    "Open Space" = "#e9ab3f",
    "Residence" = "#e76f52",
    "School" = "#9b59b6",
    "Cemetery" = "#7f8c8d"
  )) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Properties by Use Type",
    x = "",
    y = "Number of Properties"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", color = "#445ca9"),
    panel.grid.major.y = element_blank(),
    legend.position = "none"
  )
```

Over two-thirds (71%) of parcels are locked into church and cemetery designations—uses that inherently limit redevelopment options due to zoning, community sensitivity, and legal restrictions. Only about 29% of the portfolio consists of property types (open space, parking, residence) that would typically command higher valuations or offer more flexible development opportunities. 

## Development Score Distribution

The development scoring confirms use-constraints. Focus should likely center on the 16 high-potential properties for near-term value creation, while developing a longer-term strategy for the 23 moderate-potential parcels. The 59 constrained and size-restrictive properties may require hold strategies, community partnerships, or creative repurposing rather than traditional development approaches.

```{r}
#| label: fig-score-distribution
#| fig-cap: "Distribution of Development Scores Across Portfolio"
#| fig-height: 4
#| echo: false

tier_summary <- scored_parcels |>
  mutate(
    # Combine size-restricted categories
    development_category = case_when(
      development_potential %in% c("Small Parcel", "Too Large") ~ "Size-Restricted",
      TRUE ~ development_potential
    )
  ) |>
  count(development_category) |>
  mutate(
    pct = n / sum(n) * 100,
    label = paste0(n, " (", round(pct, 0), "%)"),
    potential_order = factor(development_category, 
                             levels = c("High", "Moderate", "Size-Restricted", "Constrained"))
  ) |>
  arrange(potential_order)

ggplot(tier_summary, aes(x = "", y = n, fill = potential_order)) +
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5),
            color = "white", fontface = "bold", size = 4) +
  scale_fill_manual(
    values = c(
      "High" = "#445ca9",
      "Moderate" = "#8baeaa",
      "Size-Restricted" = "#e76f52",
      "Constrained" = "#e9ab3f"
    )
  ) +
  labs(fill = "Development Potential") +
  theme_void(base_size = 12) +
  theme(
    legend.position = "bottom"
  ) +
  guides(fill = guide_legend(nrow = 1))
```

## Property Size vs Development Score

```{r}
#| label: fig-size-vs-score
#| fig-cap: "Development Scores by Property Size Category"
#| fig-height: 4
#| echo: false

scored_parcels |>
  mutate(
    size_category = case_when(
      area_acres < 0.5 ~ "< 0.5 acres (Too Small)",
      area_acres < 1.5 ~ "0.5–1.5 acres (Moderate)",
      area_acres <= 5 ~ "1.5–5 acres (High)",
      area_acres <= 10 ~ "5–10 acres (Too Large)",
      TRUE ~ "10+ acres (Too Large)"
    ),
    size_category = factor(size_category, 
                           levels = c("< 0.5 acres (Too Small)", 
                                      "0.5–1.5 acres (Moderate)", 
                                      "1.5–5 acres (High)", 
                                      "5–10 acres (Too Large)", 
                                      "10+ acres (Too Large)")),
    # Combine size-restricted categories
    development_category = case_when(
      development_potential %in% c("Small Parcel", "Too Large") ~ "Size-Restricted",
      TRUE ~ development_potential
    ),
    development_category = factor(development_category,
                                   levels = c("High", "Moderate", "Size-Restricted", "Constrained"))
  ) |>
  ggplot(aes(x = size_category, y = development_score, color = development_category)) +
  geom_jitter(width = 0.2, alpha = 0.7, size = 3) +
  scale_color_manual(
    values = c(
      "High" = "#445ca9",
      "Moderate" = "#8baeaa",
      "Size-Restricted" = "#e76f52",
      "Constrained" = "#e9ab3f"
    )
  ) +
  labs(
    x = "Parcel Size Category",
    y = "Development Score",
    color = "Development Potential"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "bottom",
    panel.grid.major.x = element_blank(),
    axis.text.x = element_text(angle = 25, hjust = 1, size = 10)
  ) +
  guides(color = guide_legend(nrow = 1))
```

The most high and moderate-potential properties concentrate in the 0.5–5 acre "sweet spot," while parcels under 0.5 acre face inherent limitations and the largest sites show more constraints. 

## Summary Narrative

### By County

#### Geographic Distribution: Understanding Two Complementary Metrics

The parcels of interest in this portfolio span multiple counties with highly variable concentrations and development potentials. Thanks to our analysis method, we can measure different aspects of development potential:

**"High Potential" Classification** answers: *"Can this be developed?"* It's a simple yes/no based on physical requirements—the property must be 1.5–5 acres, have few environmental constraints, and have documented land value. Think of it as a checklist: pass or fail.

**Development Score (0–100)** answers: *"How attractive is this for development?"* It's a weighted score considering multiple factors. A property might be physically developable but score low because the church is financially healthy (less need) or the market is weak.

These metrics can diverge significantly, revealing different types of opportunities:

| Scenario | High Potential? | Score | Meaning |
|----------|----------------|-------|---------|
| Great site, struggling church, strong market | ✓ Yes | 85 | Top priority |
| Great site, thriving church, weak market | ✓ Yes | 45 | Developable but less urgent/attractive |
| Too small, struggling church | ✗ No | 60 | High need but site doesn't qualify |

Looking at both metrics together helps identify properties that are **both** physically developable **and** strategically worth pursuing.

**Tier 1: Premium Opportunities (High Scores + High Potential)**

*   Frederick County (Winchester): The portfolio's standout performer
    
*   Albemarle & Fairfax Counties: Strong individual opportunities

    These counties offer proven development candidates with favorable market conditions offsetting some   regulatory complexity (historic districts in several cases)


**Tier 2: Volume Opportunities (High Potential Count, Modest Scores)**

*   Fauquier County: The geographic concentration story

    These properties have the right physical characteristics (good acreage, unconstrained) but face market and location limitations (rural setting, lower walkability scores, modest income growth).Multiple properties here could support coordinated affordable housing or creative mixed-use projects with patient capital.

*   Fairfax-City: Urban properties with modest outcomes

    The moderate scores despite good market fundamentals suggest regulatory complexity (likely historic districts) or current use challenges (active church buildings rather than parking lots) These would require development partners comfortable with urban regulatory environments.


**Tier 3: The King William Challenge (High Volume, Low Potential)**

*   King William County: The inverse of Fauquier AKA geographic spread

    King William contains 18% of all the parcels in this analysis but contributes zero strong development opportunities. These properties fail the physical threshold and likely represent legacy holdings—land accumulated through historical donations and gifts that don't always align with modern development economics. Consider disposition, conservation easements, or alternative mission uses (community gardens, land banks) rather than pursuing development here.


**Tier 4: Limited Engagement Counties**

*   Richmond, Fluvanna, and others: Single properties with mixed potential

These counties offer opportunistic development where individual properties merit attention but don't justify significant resource concentration. We suggest VEREP evaluate these individually as opportunities arise.


#### Key Strategic Insights:

**1. Multiple parcels ≠ multiple opportunities**

Parcel concentration isn't inherently advantageous. A county with many parcels may simply face a larger legacy management challenge—more aging buildings, more deferred maintenance, more administrative complexity—rather than greater development potential.

What matters is the concentration of *opportunity*. A cluster of "High Potential" properties in a single geography enables economies of scale: coordinated development planning, shared infrastructure investments, streamlined partner recruitment, and consolidated regulatory engagement. Scattered high-potential sites or concentrated low-potential sites don't offer these efficiencies.

Many parcels serve single congregations. The 104 total parcels overstate discrete development sites—the true count is closer to 39 high and moderate potential opportunities across fewer than 20 congregational sites.

**2. Resource allocation follows quality, not quantity**

Staff time, consulting budgets, feasibility studies, and partner outreach should flow toward sites with real potential—not spread thin across a large portfolio simply because it exists. Managing many low-potential properties is necessary work, but it's maintenance, not strategy. Concentrating resources where development can actually happen maximizes impact and avoids the trap of mistaking activity for progress.


**Bottom Line:** The Diocese should pursue an uneven geographic strategy that concentrates development resources in Frederick/Winchester (flagship quality), Fauquier (portfolio scale), and select Albemarle/Fairfax opportunities (proven viability), while being realistic that high-volume counties like King William represent asset management challenges, not development opportunities.

### High Potential Parcels

```{r}
#| label: tbl-high-potential
#| tbl-cap: "Top Development Potential Parcels"
#| echo: false

library(kableExtra)

high_potential_props <- property_profile |>
  filter(development_potential %in% c("High")) |>
  arrange(desc(development_score)) |>
  slice_head(n = 10)

if(nrow(high_potential_props) > 0) {
  high_potential_props |>
    mutate(Rank = row_number()) |>
    select(Rank, sadd, scity, scounty, rgisacre, development_score, development_potential) |>
    kable(
      col.names = c("Rank", "Address", "City", "County", "Acres", "Score", "Tier"),
      digits = c(0, 0, 0, 0, 2, 1, 0),
      align = c("c", "l", "l", "l", "r", "r", "l")
    ) |>
    kable_styling(bootstrap_options = c("striped", "hover", "condensed")) |>
    row_spec(0, bold = TRUE, background = "#445ca9", color = "white") |>
    row_spec(1:min(5, nrow(high_potential_props)), bold = TRUE)
} else {
  cat("No properties currently meet the High or Moderate development potential criteria.")
}
```

## Congregation Health Indicators

```{r}
#| label: fig-attendance-pledge
#| fig-cap: "Congregation Health and Financial Need"
#| fig-height: 5
#| echo: false 

plot_data <- property_profile |>
  filter(!is.na(avg_attendance), !is.na(avg_pledge), 
         avg_attendance > 0, avg_pledge > 0) |>
  distinct(congregation_name, .keep_all = TRUE) |>
  mutate(
    financial_status = case_when(
      financial_need >= 2 ~ "Financial Need",
      TRUE ~ "Stable"
    )
  )

need_count <- sum(plot_data$financial_status == "Financial Need")
stable_count <- sum(plot_data$financial_status == "Stable")

ggplot(plot_data, aes(x = avg_attendance, y = avg_pledge / 1000, 
                      color = financial_status, shape = financial_status)) +
  geom_point(alpha = 0.7, size = 3) +
  scale_color_manual(values = c("Financial Need" = "#e76f52", "Stable" = "#445ca9")) +
  scale_shape_manual(values = c("Financial Need" = 17, "Stable" = 16)) +
  scale_x_log10() +
  scale_y_log10(labels = scales::dollar_format(suffix = "K")) +
  annotate("text", x = 10, y = 200, 
           label = paste0("Financial Need: ", need_count, " congregations"), 
           color = "#e76f52", fontface = "bold", hjust = 0, size = 3.5) +
  annotate("text", x = 10, y = 120, 
           label = paste0("Stable: ", stable_count, " congregations"), 
           color = "#445ca9", fontface = "bold", hjust = 0, size = 3.5) +
  labs(
    x = "Average Sunday Attendance",
    y = "Annual Plate & Pledge ($K)",
    color = "", shape = ""
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "bottom")
```
::: {.callout-note}
## Understanding The Financial Need Spread 

This chart reveals a counterintuitive finding: congregations flagged as "Financial Need" often look similar to "Stable" congregations on paper. Many orange triangles (Financial Need) sit alongside blue circles (Stable) in the upper-right quadrant—healthy attendance, strong giving.

The difference isn't current performance; it's trajectory. "Financial Need" congregations have experienced significant declines in attendance or pledge revenue since 2014, even if their present numbers still appear respectable. They're not in crisis today, but the trend line points toward one.

This distinction matters strategically. Development partnerships are easier to negotiate—and more likely to succeed—while a congregation still has resources, leadership capacity, and time to plan. Waiting until finances are exhausted limits options and leverage. The goal is intervention during slow decline, not rescue after collapse.

:::

```{r}
#| echo: false

property_profile |>
  filter(financial_need >= 2, avg_pledge > 50000) |>
  distinct(congregation_name, .keep_all = TRUE) |>
  select(congregation_name, avg_attendance, avg_pledge, pct_change_attendance, pct_change_pledge) |>
  arrange(pct_change_attendance) |>
  mutate(
    avg_pledge = scales::dollar(avg_pledge),
    pct_change_attendance = paste0(round(pct_change_attendance, 1), "%"),
    pct_change_pledge = paste0(round(pct_change_pledge, 1), "%")
  ) |>
  kable(
    col.names = c("Congregation", "Avg Attendance", "Avg Pledge", "Attendance Change", "Pledge Change"),
    align = c("l", "r", "r", "r", "r")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) |>
  row_spec(0, bold = TRUE, background = "#445ca9", color = "white")
```
These congregations show the largest declines in attendance and pledge over recent years. 

Grace Church Emmanuel Parish in Fauquier County exemplifies the strategic opportunity. It ranks among the top 10 properties by development score, reports over $50,000 in annual giving, yet shows a declining trajectory that makes proactive planning urgent. Its location in Fauquier—where multiple high-potential properties cluster—creates the possibility of coordinated development efforts across sites.